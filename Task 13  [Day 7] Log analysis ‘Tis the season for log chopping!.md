# Task 13  [Day 7] Log analysis â€˜Tis the season for log chopping!

---
<img width="1440" alt="Screenshot 2023-12-27 at 9 58 45 PM" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/ed421fdf-233b-42ae-b157-87788ae12738">

---
Learning  Objectives


In this task, we will focus on the following vital learnings to assist Forensic McBlue in uncovering the potential incident:

- Revisiting log files and their importance.
- Understanding what a proxy is and breaking down the contents of a proxy log.
- Building Linux command-line skills to parse log entries manually.
- Analysing a proxy log based on typical use cases.
---

***Questions:***

How many unique IP addresses are connected to the proxy server?

<img width="1440" alt="1" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/d14a5082-93ff-4d97-b02d-a001fe2386eb">

Command 

```
cut -d ' ' -f2 access.log | sort | uniq -c | sort -n | wc -l
```

Answer 
```
9
```

---

How many unique domains were accessed by all workstations?

<img width="1440" alt="2" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/2f35bb55-7fb9-42d0-83b4-d5ffb3b37abd">


Command
```
cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq -c | sort -n | wc -l
```
Answer
```
111
```
---

What status code is generated by the HTTP requests to the least accessed domain?

<img width="1440" alt="3" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/04f918a8-d296-414e-bcc9-63717eb51864">

Command 
```
cut -d ' ' -f3,6 access.log | grep partnerservices
```

Answer
```
503
```
---


Based on the high count of connection attempts, what is the name of the suspicious domain?

<img width="1440" alt="4" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/f3daff1f-6961-46f8-a825-b9de81db1aa7">

Command
```
cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq -c | sort -n | tail -n 10
```

Answer
```
frostlings.bigbadstash.thm
```
---

What is the source IP of the workstation that accessed the malicious domain?

<img width="1440" alt="5" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/4543cabc-7034-4d06-be87-777ebcd6912a">

Command
```
cut -d ' ' -f2,3 access.log | grep frostlings
```

Answer
```
10.10.185.225
```
---

How many requests were made on the malicious domain in total?

<img width="1440" alt="6" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/1579caaa-1f84-493b-b6a0-6c7b461ea7f0">


Command
```
cut -d ' ' -f2,3 access.log | grep frostlings.big | wc -l
```

Answer
```
1581
```
---

Having retrieved the exfiltrated data, what is the hidden flag?

<img width="1440" alt="7" src="https://github.com/Lynk4/Advent-of-Cyber-2023/assets/44930131/8b33d93b-64a7-4c93-9057-f5a2a7e0b142">




Command
```
grep frostlings.bigbadstash.thm access.log | cut -d ' ' -f5 | cut -d '=' -f2 | base64 -d | grep THM
```

Answer
```
THM{a_gift_for_you_awesome_analyst!}
```
---





